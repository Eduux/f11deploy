{"version":3,"sources":["pages/ImportArea/index.js","pages/ImportArea/styles.js","images/warning.svg"],"names":["ImportArea","fileInput","useRef","useState","loading","setLoading","error","setError","handleReset","a","Swal","fire","title","text","icon","showCancelButton","confirmButtonText","cancelButtonText","confirmButtonColor","cancelButtonColor","value","api","delete","window","location","reload","handleImport","file","fileUpdate","current","files","formData","FormData","append","post","headers","src","warning","alt","onClick","type","accept","onChange","ref","size","Container","styled","div","Info","simpleFlex","ActionsContainer","ButtonReset","button","ButtonImport","LoadingContainer","Error","module","exports"],"mappings":"6QAWe,SAASA,IACtB,IAAMC,EAAYC,iBAAO,MADU,EAELC,oBAAS,GAFJ,mBAE5BC,EAF4B,KAEnBC,EAFmB,OAGTF,oBAAS,GAHA,mBAG5BG,EAH4B,KAGrBC,EAHqB,KAK7BC,EAAW,uCAAG,4BAAAC,EAAA,6DAClBF,GAAS,GADS,SAEMG,IAAKC,KAAK,CAChCC,MAAO,wBACPC,KAAM,oBACNC,KAAM,UACNC,kBAAkB,EAClBC,kBAAmB,MACnBC,iBAAkB,SAClBC,mBAAoB,UACpBC,kBAAmB,SAVH,sBAEVC,MAFU,wBAchBf,EAAW,oBAdK,mBAiBRgB,IAAIC,OAAO,SAjBH,QAmBdjB,GAAW,GACXkB,OAAOC,SAASC,SApBF,kDAsBdpB,GAAW,GACXE,EAAS,4FAvBK,0DAAH,qDA4BXmB,EAAY,uCAAG,WAAOC,GAAP,qBAAAlB,EAAA,6DACbmB,EAAa3B,EAAU4B,QAAQC,MAAM,GADxB,SAEKpB,IAAKC,KAAK,CAChCC,MAAO,+BACPC,KAAM,4EACNC,KAAM,UACNC,kBAAkB,EAClBC,kBAAmB,MACnBC,iBAAkB,SAClBC,mBAAoB,UACpBC,kBAAmB,SAVF,sBAEXC,MAFW,wBAcjBb,GAAS,GACTF,EAAW,qGAfM,UAkBT0B,EAAW,IAAIC,UACZC,OAAO,QAASL,GAnBV,UAoBTP,IAAIa,KAAK,QAASH,EAAU,CAChCI,QAAS,CACP,eAAgB,yBAtBL,eA0Bf9B,GAAW,GA1BI,UA4BSK,IAAKC,KAC3B,WACA,iCACA,WA/Ba,mBA4BPS,OAMNG,OAAOC,SAASC,SAlCH,kDAqCflB,EAAS,yGACTF,GAAW,GAtCI,0DAAH,sDA2ClB,OACE,kBAAC,YAAD,KACE,kBAAC,OAAD,KACE,yBAAK+B,IAAKC,IAASC,IAAI,YACtB,IACD,oHAEF,kBAAC,OAAD,KACE,yBAAKF,IAAKC,IAASC,IAAI,YACtB,IACD,qJAEF,kBAAC,OAAD,KACE,yBAAKF,IAAKC,IAASC,IAAI,YACtB,IACD,oJAGF,kBAAC,mBAAD,KACE,6BACE,kBAAC,cAAD,CAAaC,QAAS/B,GAAtB,mBAEF,6BACE,kBAAC,eAAD,KACE,+CACA,2BACEgC,KAAK,OACLC,OAAO,oGACPC,SAAUhB,EACViB,IAAK1C,OAMZK,GACC,kBAAC,QAAD,KAAQA,GAGTF,GACC,kBAAC,mBAAD,KACE,kBAAC,IAAD,CAASwC,KAAM,MACf,2BAAIxC,O,68DC7HP,IAAMyC,EAAYC,IAAOC,IAAV,KAITC,EAAOF,IAAOC,IAAV,IACbE,KAYSC,EAAmBJ,IAAOC,IAAV,IACzBE,KASSE,EAAcL,IAAOM,OAAV,KAkBXC,EAAeP,IAAOM,OAAV,KAkBZE,EAAmBR,IAAOC,IAAV,KAoBhBQ,EAAQT,IAAOC,IAAV,M,mBCvFlBS,EAAOC,QAAU,IAA0B","file":"static/js/1.834eb5d7.chunk.js","sourcesContent":["import React, { useState, useRef } from 'react';\r\nimport Swal from 'sweetalert2';\r\n\r\nimport api from '../../helpers/api';\r\nimport warning from '../../images/warning.svg';\r\nimport Loading from '../../components/Loading';\r\n\r\nimport {\r\n  Container, Info, ActionsContainer, ButtonReset, ButtonImport, LoadingContainer, Error,\r\n} from './styles';\r\n\r\nexport default function ImportArea() {\r\n  const fileInput = useRef(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(false);\r\n\r\n  const handleReset = async () => {\r\n    setError(false);\r\n    const { value } = await Swal.fire({\r\n      title: 'Deseja fazer o reset?',\r\n      text: 'Confirme o reset!',\r\n      icon: 'warning',\r\n      showCancelButton: true,\r\n      confirmButtonText: 'Sim',\r\n      cancelButtonText: 'Não',\r\n      confirmButtonColor: '#3085d6',\r\n      cancelButtonColor: '#d33',\r\n    });\r\n\r\n    if (value) {\r\n      setLoading('Resetando a base');\r\n\r\n      try {\r\n        await api.delete('excel');\r\n\r\n        setLoading(false);\r\n        window.location.reload();\r\n      } catch (err) {\r\n        setLoading(false);\r\n        setError('Estamos com problemas na base ou processos sendo executados, tente novamente mais tarde!');\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleImport = async (file) => {\r\n    const fileUpdate = fileInput.current.files[0];\r\n    const { value } = await Swal.fire({\r\n      title: 'Confirma a importação?',\r\n      text: 'Esse processo pode demorar alguns minutos devido a grande massa de dados!',\r\n      icon: 'warning',\r\n      showCancelButton: true,\r\n      confirmButtonText: 'Sim',\r\n      cancelButtonText: 'Não',\r\n      confirmButtonColor: '#3085d6',\r\n      cancelButtonColor: '#d33',\r\n    });\r\n\r\n    if (value) {\r\n      setError(false);\r\n      setLoading('Importando grande massa de dados, esse processo pode levar alguns minutos, não feche a pagina!');\r\n\r\n      try {\r\n        const formData = new FormData();\r\n        formData.append('excel', fileUpdate);\r\n        await api.post('excel', formData, {\r\n          headers: {\r\n            'content-type': 'multipart/form-data',\r\n          },\r\n        });\r\n\r\n        setLoading(false);\r\n\r\n        const { value } = await Swal.fire(\r\n          'Sucesso!',\r\n          'Arquivo importado com sucesso!',\r\n          'success',\r\n        );\r\n        if (value) {\r\n          window.location.reload();\r\n        }\r\n      } catch (err) {\r\n        setError('Servidor está com problemas ou algum processo está sendo executado, tente novamente mais tarde!');\r\n        setLoading(false);\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Container>\r\n      <Info>\r\n        <img src={warning} alt=\"warning\" />\r\n        {' '}\r\n        <p>Atenção é indispensável resetarmos a base antes de importar os arquivos!</p>\r\n      </Info>\r\n      <Info>\r\n        <img src={warning} alt=\"warning\" />\r\n        {' '}\r\n        <p>Colunas requeridas: UF, MUNICIPIO, LOGRADOURO, NUM_FACHADA, COMPLEMENTO, CEP, BAIRRO, QUANTIDADE_UMS, COD_VIABILIDADE</p>\r\n      </Info>\r\n      <Info>\r\n        <img src={warning} alt=\"warning\" />\r\n        {' '}\r\n        <p>Um arquivo de cada vez!, a importação pode demorar devido a grande massa de dados +- 700mil linhas por arquivo</p>\r\n      </Info>\r\n\r\n      <ActionsContainer>\r\n        <div>\r\n          <ButtonReset onClick={handleReset}>Resetar a base</ButtonReset>\r\n        </div>\r\n        <div>\r\n          <ButtonImport>\r\n            <p>Importar arquivo</p>\r\n            <input\r\n              type=\"file\"\r\n              accept=\".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel\"\r\n              onChange={handleImport}\r\n              ref={fileInput}\r\n            />\r\n          </ButtonImport>\r\n        </div>\r\n      </ActionsContainer>\r\n\r\n      {error && (\r\n        <Error>{error}</Error>\r\n      )}\r\n\r\n      {loading && (\r\n        <LoadingContainer>\r\n          <Loading size={160} />\r\n          <p>{loading}</p>\r\n        </LoadingContainer>\r\n      )}\r\n    </Container>\r\n  );\r\n}\r\n","import styled from 'styled-components';\r\n\r\nimport { simpleFlex } from '../../styles/mixins';\r\n\r\nexport const Container = styled.div`\r\n  \r\n`;\r\n\r\nexport const Info = styled.div`\r\n  ${simpleFlex}\r\n  img {\r\n    width: 30px;\r\n  }\r\n\r\n  p {\r\n    margin-left: 10px;\r\n    font-size: 14px;\r\n    font-weight: bold;\r\n  }\r\n`;\r\n\r\nexport const ActionsContainer = styled.div`\r\n  ${simpleFlex}\r\n  justify-content: space-between;\r\n  margin-top: 50px;\r\n\r\n  div {\r\n    flex: 1;\r\n  }\r\n`;\r\n\r\nexport const ButtonReset = styled.button`\r\n  cursor: pointer;\r\n  border: 0;\r\n  background-color: #058586;\r\n  color: white;\r\n  padding: 8px 30px;\r\n  border-radius: 4px;\r\n  font-size: 18px;\r\n  -webkit-transition: 0.4s ease all;\r\n  transition: 0.4s ease all;\r\n  width: 90%;\r\n\r\n  \r\n  &:hover {\r\n    opacity: 0.8;\r\n  }\r\n`;\r\n\r\nexport const ButtonImport = styled.button`\r\n  cursor: pointer;\r\n  border: 0;\r\n  background-color: #122e41;\r\n  color: white;\r\n  padding: 8px 30px;\r\n  border-radius: 4px;\r\n  font-size: 18px;\r\n  -webkit-transition: 0.4s ease all;\r\n  transition: 0.4s ease all;\r\n  width: 90%;\r\n\r\n  \r\n  &:hover {\r\n    opacity: 0.8;\r\n  }\r\n`;\r\n\r\nexport const LoadingContainer = styled.div`\r\n  position: fixed;\r\n  top: 0;\r\n  right: 0;\r\n  left: 0;\r\n  bottom: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  background: rgba(0, 0, 0, 0.7);\r\n  color: white;\r\n  justify-content: center;\r\n  display: flex;\r\n  align-items: center;\r\n  flex-direction: column;\r\n\r\n  p {\r\n    margin-top: 30px;\r\n  }\r\n`;\r\n\r\nexport const Error = styled.div`\r\n  margin-top: 50px;\r\n  color: red;\r\n  font-size: 18px;\r\n  font-weight: bold;\r\n`;","module.exports = __webpack_public_path__ + \"static/media/warning.3bae402e.svg\";"],"sourceRoot":""}